{"ast":null,"code":"import React,{useState}from'react';import{Box,Paper,Typography,Accordion,AccordionSummary,AccordionDetails,Switch,FormControlLabel,Chip,Divider,Alert,List,ListItem,ListItemText,ListItemSecondaryAction,Collapse,IconButton,Tooltip,Badge,Grid,Card,CardContent}from'@mui/material';import{ExpandMore,Refresh,Settings,BugReport,Visibility,VisibilityOff,CheckCircle,Error,Warning}from'@mui/icons-material';import{useFeatureFlags}from'../../contexts/FeatureFlagsContext';import{FEATURE_CATEGORIES,DEFAULT_FEATURE_FLAGS}from'../../services/unleashService';import{useFeatureFlagsDebug}from'../../hooks/useFeatureFlags';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FeatureFlagsDebug=_ref=>{let{position='bottom-right',compact=false,visible=false,onToggleVisibility}=_ref;const{getAllFlags,isReady,isInitialized,status,refresh,updateContext}=useFeatureFlags();const{flags:debugFlags,refresh:refreshDebug}=useFeatureFlagsDebug();const[isExpanded,setIsExpanded]=useState(!compact);const[selectedCategory,setSelectedCategory]=useState('ALL');const[contextOverrides,setContextOverrides]=useState({});const[showOnlyDifferences,setShowOnlyDifferences]=useState(false);// Get position styles\nconst getPositionStyles=()=>{const baseStyles={position:'fixed',zIndex:9999,maxWidth:compact?320:600,maxHeight:compact?400:800,overflow:'auto'};switch(position){case'bottom-right':return{...baseStyles,bottom:16,right:16};case'bottom-left':return{...baseStyles,bottom:16,left:16};case'top-right':return{...baseStyles,top:16,right:16};case'top-left':return{...baseStyles,top:16,left:16};default:return{...baseStyles,bottom:16,right:16};}};// Get status indicator\nconst getStatusIndicator=()=>{if(!isReady){return{color:'warning',icon:/*#__PURE__*/_jsx(Warning,{}),text:'Loading'};}if(!isInitialized){return{color:'error',icon:/*#__PURE__*/_jsx(Error,{}),text:'Failed'};}return{color:'success',icon:/*#__PURE__*/_jsx(CheckCircle,{}),text:'Ready'};};// Filter flags based on category and differences\nconst getFilteredFlags=()=>{const allFlags=getAllFlags(contextOverrides);let filteredFlags=allFlags;// Filter by category\nif(selectedCategory!=='ALL'){const categoryKeys=FEATURE_CATEGORIES[selectedCategory];filteredFlags=Object.fromEntries(Object.entries(allFlags).filter(_ref2=>{let[key]=_ref2;return categoryKeys.includes(key);}));}// Show only differences from defaults\nif(showOnlyDifferences){filteredFlags=Object.fromEntries(Object.entries(filteredFlags).filter(_ref3=>{let[key,value]=_ref3;return value!==DEFAULT_FEATURE_FLAGS[key];}));}return filteredFlags;};const statusInfo=getStatusIndicator();const filteredFlags=getFilteredFlags();// Toggle visibility\nconst toggleVisibility=()=>{const newVisible=!visible;onToggleVisibility===null||onToggleVisibility===void 0?void 0:onToggleVisibility(newVisible);};// Refresh all flags\nconst handleRefresh=()=>{refresh();refreshDebug();};// Update context\nconst handleContextUpdate=(key,value)=>{const newContext={...contextOverrides,[key]:value};setContextOverrides(newContext);updateContext(newContext);};if(!visible){// Floating toggle button\nreturn/*#__PURE__*/_jsx(Box,{sx:getPositionStyles(),children:/*#__PURE__*/_jsx(Tooltip,{title:\"Feature Flags Debug Panel\",children:/*#__PURE__*/_jsx(IconButton,{onClick:toggleVisibility,sx:{backgroundColor:'primary.main',color:'white','&:hover':{backgroundColor:'primary.dark'},boxShadow:2},children:/*#__PURE__*/_jsx(Badge,{badgeContent:Object.keys(filteredFlags).length,color:statusInfo.color,variant:\"dot\",children:/*#__PURE__*/_jsx(Settings,{})})})})});}return/*#__PURE__*/_jsx(Box,{sx:getPositionStyles(),children:/*#__PURE__*/_jsxs(Paper,{elevation:8,sx:{opacity:0.95,backdropFilter:'blur(4px)'},children:[/*#__PURE__*/_jsxs(Box,{sx:{p:2,display:'flex',alignItems:'center',justifyContent:'space-between',borderBottom:'1px solid',borderColor:'divider'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(BugReport,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",sx:{fontWeight:600,fontSize:'0.875rem'},children:\"Feature Flags\"}),/*#__PURE__*/_jsx(Chip,{icon:statusInfo.icon,label:statusInfo.text,size:\"small\",color:statusInfo.color,variant:\"outlined\"})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Refresh flags\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:handleRefresh,children:/*#__PURE__*/_jsx(Refresh,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Toggle panel size\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>setIsExpanded(!isExpanded),children:isExpanded?/*#__PURE__*/_jsx(VisibilityOff,{}):/*#__PURE__*/_jsx(Visibility,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Close panel\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:toggleVisibility,children:/*#__PURE__*/_jsx(ExpandMore,{sx:{transform:'rotate(90deg)'}})})})]})]}),/*#__PURE__*/_jsx(Collapse,{in:isExpanded,children:/*#__PURE__*/_jsxs(Box,{sx:{p:2},children:[/*#__PURE__*/_jsx(Card,{variant:\"outlined\",sx:{mb:2},children:/*#__PURE__*/_jsx(CardContent,{sx:{py:1.5},children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Status\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:\"600\",children:isInitialized?'Connected':'Fallback Mode'})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:6,children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Flag Count\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",fontWeight:\"600\",children:[Object.keys(filteredFlags).length,\" / \",Object.keys(DEFAULT_FEATURE_FLAGS).length]})]})]})})}),/*#__PURE__*/_jsx(Box,{sx:{mb:2,display:'flex',flexWrap:'wrap',gap:1},children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Switch,{size:\"small\",checked:showOnlyDifferences,onChange:e=>setShowOnlyDifferences(e.target.checked)}),label:/*#__PURE__*/_jsx(Typography,{variant:\"caption\",children:\"Only Differences\"})})}),/*#__PURE__*/_jsxs(Box,{sx:{mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",gutterBottom:true,children:\"Category Filter\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexWrap:'wrap',gap:0.5},children:[/*#__PURE__*/_jsx(Chip,{label:\"ALL\",size:\"small\",onClick:()=>setSelectedCategory('ALL'),color:selectedCategory==='ALL'?'primary':'default',variant:selectedCategory==='ALL'?'filled':'outlined'}),Object.keys(FEATURE_CATEGORIES).map(category=>/*#__PURE__*/_jsx(Chip,{label:category,size:\"small\",onClick:()=>setSelectedCategory(category),color:selectedCategory===category?'primary':'default',variant:selectedCategory===category?'filled':'outlined'},category))]})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsx(Box,{sx:{maxHeight:300,overflow:'auto'},children:Object.keys(filteredFlags).length===0?/*#__PURE__*/_jsx(Alert,{severity:\"info\",sx:{mb:2},children:showOnlyDifferences?'No flags differ from defaults':'No flags in selected category'}):/*#__PURE__*/_jsx(List,{dense:true,children:Object.entries(filteredFlags).map(_ref4=>{let[flagName,isEnabled]=_ref4;const isDefault=isEnabled===DEFAULT_FEATURE_FLAGS[flagName];return/*#__PURE__*/_jsxs(ListItem,{sx:{px:1,py:0.5,borderRadius:1,backgroundColor:isDefault?'transparent':'action.hover'},children:[/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{fontWeight:isDefault?400:600},children:flagName.replace(/_/g,' ')}),secondary:/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:flagName})}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:/*#__PURE__*/_jsx(Chip,{label:isEnabled?'ON':'OFF',size:\"small\",color:isEnabled?'success':'default',variant:isDefault?'outlined':'filled'})})]},flagName);})})}),process.env.NODE_ENV==='development'&&/*#__PURE__*/_jsxs(Accordion,{variant:\"outlined\",sx:{mt:2},children:[/*#__PURE__*/_jsx(AccordionSummary,{expandIcon:/*#__PURE__*/_jsx(ExpandMore,{}),children:/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",children:[\"Context Overrides (\",Object.keys(contextOverrides).length,\")\"]})}),/*#__PURE__*/_jsx(AccordionDetails,{children:/*#__PURE__*/_jsx(Alert,{severity:\"warning\",sx:{mb:2},children:\"Development only: Override context for testing\"})})]})]})})]})});};export default FeatureFlagsDebug;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}