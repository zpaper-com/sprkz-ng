{"ast":null,"code":"import React,{useState,useEffect,useMemo}from'react';import{Box,Drawer,List,ListItem,ListItemButton,Typography,IconButton,CircularProgress,Tooltip,useTheme,useMediaQuery,Collapse,Fade,Chip,Paper,SwipeableDrawer}from'@mui/material';import{ChevronLeft,ChevronRight,CheckCircle,RadioButtonUnchecked,PictureAsPdf,Assignment,Close}from'@mui/icons-material';import{PDFService}from'../../services/pdfService';import{animations}from'../../theme/theme';import{microInteractionStyles,presets}from'../../utils/microInteractions';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PageThumbnail=_ref=>{let{pageNumber,pdfDoc,isSelected,isCompleted,hasFormFields,onClick}=_ref;const[thumbnail,setThumbnail]=useState(null);const[loading,setLoading]=useState(false);const[error,setError]=useState(false);useEffect(()=>{let isMounted=true;const generateThumbnail=async()=>{if(thumbnail)return;// Already loaded\ntry{setLoading(true);setError(false);const page=await PDFService.getPage(pdfDoc,pageNumber);const thumbnailDataUrl=await PDFService.generateThumbnail(page,120);if(isMounted){setThumbnail(thumbnailDataUrl);}}catch(err){console.error(`Failed to generate thumbnail for page ${pageNumber}:`,err);if(isMounted){setError(true);}}finally{if(isMounted){setLoading(false);}}};generateThumbnail();return()=>{isMounted=false;};},[pageNumber,pdfDoc,thumbnail]);return/*#__PURE__*/_jsx(ListItem,{disablePadding:true,children:/*#__PURE__*/_jsxs(ListItemButton,{onClick:()=>onClick(pageNumber),selected:isSelected,sx:{flexDirection:'column',py:1,px:2,minHeight:160,border:isSelected?'2px solid':'1px solid',borderColor:isSelected?'primary.main':'divider',borderRadius:1,mb:1,mx:1,...microInteractionStyles.hoverLift,'&:hover':{borderColor:'primary.main',backgroundColor:'action.hover'}},children:[/*#__PURE__*/_jsxs(Box,{sx:{width:120,height:120,display:'flex',alignItems:'center',justifyContent:'center',border:'1px solid',borderColor:'divider',borderRadius:1,mb:1,overflow:'hidden',backgroundColor:'grey.50',position:'relative'},children:[loading?/*#__PURE__*/_jsx(CircularProgress,{size:24}):error?/*#__PURE__*/_jsx(PictureAsPdf,{color:\"disabled\"}):thumbnail?/*#__PURE__*/_jsx(\"img\",{src:thumbnail,alt:`Page ${pageNumber} thumbnail`,style:{maxWidth:'100%',maxHeight:'100%',objectFit:'contain'}}):/*#__PURE__*/_jsx(PictureAsPdf,{color:\"disabled\"}),/*#__PURE__*/_jsx(Box,{position:\"absolute\",top:4,right:4,sx:{backgroundColor:'background.paper',borderRadius:'50%',p:0.25},children:isCompleted?/*#__PURE__*/_jsx(CheckCircle,{color:\"success\",fontSize:\"small\"}):hasFormFields?/*#__PURE__*/_jsx(RadioButtonUnchecked,{color:\"warning\",fontSize:\"small\"}):/*#__PURE__*/_jsx(RadioButtonUnchecked,{color:\"disabled\",fontSize:\"small\"})})]}),/*#__PURE__*/_jsxs(Box,{textAlign:\"center\",width:\"100%\",children:[/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",fontWeight:\"bold\",children:[\"Page \",pageNumber]}),hasFormFields&&/*#__PURE__*/_jsx(Typography,{variant:\"caption\",display:\"block\",color:\"textSecondary\",children:isCompleted?'Completed':'Has forms'})]})]})});};export const ThumbnailSidebar=_ref2=>{let{pdfDoc,currentPage,completedPages,pagesWithFormFields,onPageSelect,open=true,onToggle}=_ref2;const theme=useTheme();const isMobile=useMediaQuery(theme.breakpoints.down('md'));const[isCollapsed,setIsCollapsed]=useState(isMobile);// Auto-collapse on mobile\nuseEffect(()=>{setIsCollapsed(isMobile);},[isMobile]);// Generate page list\nconst pages=useMemo(()=>{if(!pdfDoc)return[];return Array.from({length:pdfDoc.numPages},(_,index)=>index+1);},[pdfDoc]);// Calculate completion statistics\nconst completionStats=useMemo(()=>{const totalPages=pages.length;const completedCount=completedPages.size;const pagesWithForms=pagesWithFormFields.size;return{totalPages,completedCount,pagesWithForms,completionPercentage:pagesWithForms>0?Math.round(completedCount/pagesWithForms*100):0};},[pages.length,completedPages.size,pagesWithFormFields.size]);const handleToggleCollapse=()=>{setIsCollapsed(!isCollapsed);onToggle===null||onToggle===void 0?void 0:onToggle();};const drawerWidth=isCollapsed?60:160;const drawerContent=/*#__PURE__*/_jsxs(Box,{sx:{height:'100%',display:'flex',flexDirection:'column',...animations.fadeIn},children:[/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,borderBottom:'1px solid',borderColor:'divider',display:'flex',alignItems:'center',justifyContent:'space-between',backgroundColor:'background.paper',borderRadius:0},children:[/*#__PURE__*/_jsx(Collapse,{in:!isCollapsed,orientation:\"horizontal\",children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Assignment,{color:\"primary\",fontSize:\"small\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontSize:\"0.875rem\",fontWeight:600,children:\"Pages\"})]})}),/*#__PURE__*/_jsx(Tooltip,{title:isCollapsed?\"Expand sidebar\":\"Collapse sidebar\",placement:\"right\",children:/*#__PURE__*/_jsx(IconButton,{onClick:handleToggleCollapse,size:\"small\",sx:{ml:isCollapsed?0:'auto',...presets.iconButton},children:isCollapsed?/*#__PURE__*/_jsx(ChevronRight,{}):/*#__PURE__*/_jsx(ChevronLeft,{})})})]}),/*#__PURE__*/_jsx(Collapse,{in:!isCollapsed,children:/*#__PURE__*/_jsxs(Box,{sx:{p:2,backgroundColor:'background.elevated'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1,mb:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"textSecondary\",children:\"Progress\"}),/*#__PURE__*/_jsx(Chip,{label:`${completionStats.completionPercentage}%`,size:\"small\",color:completionStats.completionPercentage===100?'success':'primary',sx:{height:'20px',fontSize:'0.75rem'}})]}),/*#__PURE__*/_jsxs(Typography,{variant:\"caption\",color:\"textSecondary\",display:\"block\",children:[completionStats.completedCount,\" of \",completionStats.pagesWithForms,\" pages with forms\"]}),/*#__PURE__*/_jsx(Box,{sx:{height:'4px',backgroundColor:'divider',borderRadius:'2px',mt:1,overflow:'hidden'},children:/*#__PURE__*/_jsx(Box,{sx:{height:'100%',backgroundColor:completionStats.completionPercentage===100?'success.main':'primary.main',borderRadius:'2px',width:`${completionStats.completionPercentage}%`,transition:'width 0.5s ease-in-out'}})})]})}),/*#__PURE__*/_jsx(Box,{sx:{flex:1,overflowY:'auto'},children:isCollapsed?/*#__PURE__*/// Collapsed view - just page numbers with indicators\n_jsx(List,{sx:{p:0},children:pages.map(pageNumber=>/*#__PURE__*/_jsx(Fade,{in:true,timeout:300+pageNumber*50,children:/*#__PURE__*/_jsx(ListItem,{disablePadding:true,children:/*#__PURE__*/_jsx(Tooltip,{title:`Page ${pageNumber}${pagesWithFormFields.has(pageNumber)?' (has forms)':''}`,placement:\"right\",arrow:true,children:/*#__PURE__*/_jsx(ListItemButton,{onClick:()=>onPageSelect(pageNumber),selected:pageNumber===currentPage,sx:{minHeight:'52px',// Touch-friendly\njustifyContent:'center',px:1,mx:0.5,mb:0.5,borderRadius:2,...microInteractionStyles.hoverScale,...microInteractionStyles.focusRing,'&.Mui-selected':{backgroundColor:'primary.main',color:'primary.contrastText','&:hover':{backgroundColor:'primary.dark'}}},children:/*#__PURE__*/_jsxs(Box,{sx:{position:'relative',display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:pageNumber===currentPage?700:600,sx:{fontSize:'0.875rem',lineHeight:1},children:pageNumber}),/*#__PURE__*/_jsx(Box,{sx:{position:'absolute',top:-8,right:-8,width:12,height:12,borderRadius:'50%',backgroundColor:completedPages.has(pageNumber)?'success.main':pagesWithFormFields.has(pageNumber)?'warning.main':'transparent',border:completedPages.has(pageNumber)?'2px solid white':pagesWithFormFields.has(pageNumber)?'2px solid white':'none',opacity:completedPages.has(pageNumber)||pagesWithFormFields.has(pageNumber)?1:0,transition:'all 0.2s'}})]})})})})},pageNumber))}):/*#__PURE__*/// Expanded view - full thumbnails\n_jsx(List,{sx:{p:0},children:pages.map(pageNumber=>/*#__PURE__*/_jsx(PageThumbnail,{pageNumber:pageNumber,pdfDoc:pdfDoc,isSelected:pageNumber===currentPage,isCompleted:completedPages.has(pageNumber),hasFormFields:pagesWithFormFields.has(pageNumber),onClick:onPageSelect},pageNumber))})})]});if(isMobile){return/*#__PURE__*/_jsx(SwipeableDrawer,{variant:\"temporary\",open:open||false,onClose:onToggle||(()=>{}),onOpen:onToggle||(()=>{}),disableBackdropTransition:true,disableDiscovery:true,ModalProps:{keepMounted:true// Better mobile performance\n},sx:{'& .MuiDrawer-paper':{width:isCollapsed?80:280,boxSizing:'border-box',transition:theme.transitions.create('width',{easing:theme.transitions.easing.easeOut,duration:theme.transitions.duration.enteringScreen}),borderTopRightRadius:16,borderBottomRightRadius:16,boxShadow:theme.shadows[8]},'& .MuiBackdrop-root':{backgroundColor:'rgba(0, 0, 0, 0.3)',backdropFilter:'blur(4px)'}},children:/*#__PURE__*/_jsxs(Box,{sx:{...drawerContent.props.sx,height:'100vh',overflow:'hidden'},children:[/*#__PURE__*/_jsxs(Paper,{elevation:0,sx:{p:2,display:'flex',alignItems:'center',justifyContent:'space-between',backgroundColor:'background.paper',borderRadius:0,borderBottom:'1px solid',borderColor:'divider'},children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(Assignment,{color:\"primary\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontSize:\"1rem\",fontWeight:600,children:\"Document Pages\"})]}),/*#__PURE__*/_jsx(IconButton,{onClick:onToggle,size:\"large\",sx:{minWidth:'48px',minHeight:'48px'},children:/*#__PURE__*/_jsx(Close,{})})]}),drawerContent.props.children.slice(1),\" \"]})});}return/*#__PURE__*/_jsx(Drawer,{variant:\"permanent\",sx:{width:drawerWidth,flexShrink:0,transition:theme.transitions.create('width',{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen}),'& .MuiDrawer-paper':{width:drawerWidth,boxSizing:'border-box',transition:theme.transitions.create('width',{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen}),overflowX:'hidden'}},children:drawerContent});};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}